---
#-------------------------------------------------------------------------------
#
#  !!! AUTO GENERATED from the StigTemplateCreater.html utility !!!
#
# Do not modify file without good cause.  This file was generated from the DISA
# XCCDF (The eXtensible Configuration Checklist Description Format) STIGs file.
#
#Project: NAWCAD Data Center Automation
#File:    blank_rhel7_v2r3.ckl.master.yml
#Author:  Auto Generated
#Date:    Mon, 03 Jun 2019 16:21:12 GMT
#
#-------------------------------------------------------------------------------
#
- block:

  - name: Read caveats file and split into Caveat_xxxxx variables.
    set_fact:
      "{{ 'caveat_' + item.split(' ',1)[0] | lower | replace('v-','') }}": "{{ item.split(' ',1)[1] }}"
    when: item[0:2] | lower == 'v-'
    loop: "{{ ('\n' + lookup('file','../files/CaveatsFlatFile.txt')).split('\n~') }}"

  - name: prep.yml
    import_tasks: prep.yml

# - name: Loop through vulnerability checks
#   include_tasks: "{{ item }}.yml"
#   #with_items: "{{ lookup('file','vul_list').split('\n') }}"

  - name: STIG-RHEL7-V-72213
    import_tasks: STIG-RHEL7-V-72213.yml

  - name: post.yml
    import_tasks: post.yml
  
  when: "ansible_facts['os_family'] == 'RedHat' and ansible_facts['distribution_major_version'] == '7'"


